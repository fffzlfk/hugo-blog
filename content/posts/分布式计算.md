---
title: "分布式计算"
date: 2021-03-13T13:57:34+08:00
toc: true
draft: false
summary: "Distributed Computing"
tags:
    - Acadmic
---

## 概述

### 分布式系统定义

**分布式计算**：多个通过网络互联的计算节点通过相互协作共同完成计算任务。

#### 理解分布式系统定义的几个要点

1. 多个计算节点：计算节点抽象为有限状态机（图灵机）
2. 网络互联
3. 独立自治
4. 相互协作共同完成目标
5. 消息传递模型
    {{<image src="https://files.catbox.moe/6krt9v.png" position="center" style="zoom: 60% ;">}}

### 与并行计算的关系

不同层次的并行计算：
- 指令级并行：多指令并行；单指多数并行（向量指令）
- CPU多核并行：多线程编程
- 多CPU并行（一致性内存访问）：多线程编程
- 多CPU并行（非一致性内存访问）：超级计算机
- 基于GPU的并行：单指多数并行；CUDA、OpenCL
- 多机并行：就业消息传递的分布式计算（share nothing）

### 构建分布式系统的目的

- 提高计算能力
- 提高存储能力
- 提高网络吞吐能力（并发访问能力）
- 提高可靠性（解决局部失效问题）
- 提高安全性（解决被局部攻击问题）
- 提高可扩展性（解决瓶颈问题）
- 实现资源共享
- 实现跨越时空的协同服务（发挥不同节点的优势）

### 衡量分布式系统优劣的特性

- 可扩展性/可伸缩性（Scalability）
    - 垂直可扩展性（Vertical Scalablility）
    - 水平可扩展性（Horizontal Scalability）
- 容错性（Fault Tolerance/Reliability）
    - 可用性（Availability）
    - 可恢复性（Recoverability）
- 透明性（Transparency）
- 开放性（Openness）
- 安全性（Security）
- 可维护性（Maintainability）

### 设计分布式系统的挑战

- 异构性
- 自治
- 局部视图
- 开放性
- 可扩展性
- 故障处理
- 安全性
- 透明性
- 服务质量保证

### 关于分布式一致性

{{<image src="https://files.catbox.moe/mjtetf.png" position="center" style="zoom: 50% ;">}}

### 几类分布式系统框架模式

- **客户端-服务器**（Client-Server）模式
{{<image src="https://files.catbox.moe/c4agmt.png" position="center" style="zoom: 50% ;">}}
    - 客户端发出服务请求，服务端根据客户端请求参数完成实际运算，并将运算结果返回给客户端
    - 客户端运算任务轻、服务端运算任务重
    - 客户端生命周期短、服务端生命周期长
    - 服务端一般要应对并发问题
    - 客户端一般负责和用户进行交互
    - 瘦客户端/胖服务端
- Client—Cluster模式
    - 是Client-Server模式的变种
    - 服务端由多个服务器构成，共同承担计算任务
    - 在宏观逻辑上，多个服务器构成的集群可以视为单一的功能强大的计算节点。客户端感觉不到服务端的实际构成。
- **主从**（Master-Slave）模式  
{{<image src="https://files.catbox.moe/cwxyyw.png" position="center" style="zoom: 80% ;">}}

    - 主节点（Master）负责将总任务分解为多个自任务分发给各个从节点（Slave，也叫Worker节点）
    - 主节点监视各个从节点的任务执行情况，将执行失败的任务调度给其他的从节点完成
    - 主节点在分配任务时会参考各个节点的当前负载情况
- **总线**模式  
{{<image src="https://files.catbox.moe/1jcgxf.png" position="center" style="zoom: 30% ;">}}
    - 不同节点通过虚拟总线相连
    - 消息发送者不必知道接收者是谁，接收者也不知道发送者是谁
    - 发送者和接收者之间用异步方式通信
    - 一种松耦合结构
    - 不同节点完成不同功能，分工协作
- **对等**（Peer-to-Peer）模式
    - 系统中每个计算节点在任务分工上是完全对等的
    - 完全相同软件在不同的计算机上运行，只是初始化参数不同
    - 结构化P2P：不同节点之间的交互模式遵循固定规律
    - 非结构化P2P：不同节点之间的交互模式没有固定规律
- 混合模式

### 常用的负载均衡策略

- 随机
- 轮询
- 固定权重值
- IP哈希（基于一致性随机散列函数）
- 最少TCP连接数
- 最小响应时间
- 基于各服务器实际负载的动态负载均衡算法

### 中间件的基本概念

{{<image src="https://files.catbox.moe/9ygrjt.png" position="center" style="zoom: 30% ;">}}

#### 中间件的作用

- 为开发者提供高层的编程抽象，屏蔽分布式系统的底层的异构型复杂性
- 提高互操作性和可移植性
- 提供分布式系统的基础设施服务

#### 常用的中间件

- 远程过程调用中间件
- 分布式对象中间件
- 分布式组件中间件
- 消息队列中间件
- Web服务中间件
- P2P中间件

#### 中间件的表现形式

- 作为独立的后台进程存在
- 作为运行时的函数库/类库存在（LIB静态库、DLL动态库、Jar包等）
- 作为源代码级的函数库/类库存在
- 作为高级语言解释器的一部分存在
- 作为辅助编译工具存在
- 作为高级语言编译器的一部分存在

### 抽象理论模型

- 交互模式
    - 同步模型
    - 异步模型
- 信息故障模式
- 节点故障模式
    - 失效停止模式（Fail—Stop）
    - 失效停止恢复模式
    - 拜占庭模式
    - 发送者验证拜占庭模式
    - 理性拜占庭模式
    
## 分布式节点之间的通信技术

### TCP/IP网络体系介绍

- TCP/IP先于OSI模型，不完全符合OSI标准
{{<image src="https://files.catbox.moe/8iiy7l.png" position="center" style="zoom: 60% ;">}}
- TCP/IP四层模型（也可分为五层，将网络接口分为两层）
{{<image src="https://files.catbox.moe/m70wnd.png" position="center" style="zoom: 60% ;">}}

### Socket

#### 什么是Socket

**网络层和传输层**提供给**应用层**的标准化编程接口（或称为编程接口）
{{<image src="https://files.catbox.moe/0zwhtu.png" position="center" style="zoom: 60% ;">}}

#### 套接字分类-Socket类型

- 流式套接字
- 数据报套接字
- 原始套接字

    {{<image src="https://files.catbox.moe/8do6bt.png" position="center" style="zoom: 60% ;">}}

#### 如何标识一个Socket

- 五元组：`<SIP, sPort, dIP, dPort, 协议>`
    - 本地IP地址
    - 本地端口号（通常临时分配：1024~5000）
    - 远程IP地址
    - 远程端口号（通常使用保留端口号1~1023）
    - 协议类型（注意TCP 53和UDP 53是不同的）

- TCP套接字编程典型模型
    {{<image src="https://files.catbox.moe/iqu4ni.png" position="center" style="zoom: 60% ;">}}
- UDP套接字编程典型模型
    {{<image src="https://files.catbox.moe/ijma9k.png" position="center" style="zoom: 60% ;">}}

### 并发服务技术

- 基于多线程的并发服务技术
- 基于线程池的并发服务技术

